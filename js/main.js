!function(e){function n(n){for(var r,s,l=n[0],o=n[1],u=n[2],f=0,c=[];f<l.length;f++)s=l[f],i[s]&&c.push(i[s][0]),i[s]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);for(d&&d(n);c.length;)c.shift()();return a.push.apply(a,u||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],r=!0,l=1;l<t.length;l++){var o=t[l];0!==i[o]&&(r=!1)}r&&(a.splice(n--,1),e=s(s.s=t[0]))}return e}var r={},i={0:0},a=[];function s(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=r,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)s.d(t,r,function(n){return e[n]}.bind(null,r));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="";var l=window.webpackJsonp=window.webpackJsonp||[],o=l.push.bind(l);l.push=n,l=l.slice();for(var u=0;u<l.length;u++)n(l[u]);var d=o;a.push([11,1]),t()}({10:function(e,n,t){var r=t(16);e.exports=(r.default||r).template({1:function(e,n,t,r,i){var a,s,l=null!=n?n:e.nullContext||{},o=t.helperMissing,u=e.escapeExpression;return'  <li\n    class="friend"\n    data-id="'+u("function"==typeof(s=null!=(s=t.id||(null!=n?n.id:n))?s:o)?s.call(l,{name:"id",hash:{},data:i}):s)+'"\n'+(null!=(a=t.unless.call(l,null!=n?n.favorites:n,{name:"unless",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))?a:"")+'  >\n    <div>\n      <img\n        src="'+u("function"==typeof(s=null!=(s=t.photo_50||(null!=n?n.photo_50:n))?s:o)?s.call(l,{name:"photo_50",hash:{},data:i}):s)+'"\n        height="45"\n        width="45"\n        draggable="false"\n      >\n      <p>'+u("function"==typeof(s=null!=(s=t.first_name||(null!=n?n.first_name:n))?s:o)?s.call(l,{name:"first_name",hash:{},data:i}):s)+" "+u("function"==typeof(s=null!=(s=t.last_name||(null!=n?n.last_name:n))?s:o)?s.call(l,{name:"last_name",hash:{},data:i}):s)+'</p>\n    </div>\n    <button class="friend__button">\n'+(null!=(a=t.if.call(l,null!=n?n.favorites:n,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.program(6,i,0),data:i}))?a:"")+"    </button>\n  </li>\n"},2:function(e,n,t,r,i){return'    draggable="true"\n'},4:function(e,n,t,r,i){return'        <i\n          class="fas fa-times"\n          style="color: #c4c4c4; font-size: 2.2rem; pointer-events: none;"\n        ></i>\n'},6:function(e,n,t,r,i){return'        <i\n          class="fa fa-plus"\n          style="color: #c4c4c4; font-size: 2.2rem; pointer-events: none;"\n        ></i>\n'},compiler:[7,">= 4.0.0"],main:function(e,n,t,r,i){var a;return null!=(a=t.blockHelperMissing.call(n,e.lambda(n,n),{name:"this",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?a:""},useData:!0})},11:function(e,n,t){e.exports=t(33)},12:function(e,n,t){},33:function(e,n,t){"use strict";t.r(n);t(12);var r=t(6),i=t(4),a=t(7),s=t.n(a),l=t(9),o=t.n(l),u=t(0),d=t.n(u),f=t(1),c=t.n(f),v=t(5),h=t.n(v),p=function(){function e(){d()(this,e)}return c()(e,null,[{key:"init",value:function(){return h.a.init({apiId:6766409}),new Promise(function(e,n){h.a.Auth.login(function(t){t.session?e():n(new Error("Не удалось авторизироваться"))},2)})}},{key:"callAPI",value:function(e,n){return n.v="5.88",new Promise(function(t,r){h.a.api(e,n,function(e){e.error?r(e.error):t(e.response)})})}}]),e}(),m=function(){function e(){d()(this,e)}return c()(e,null,[{key:"loadFriends",value:function(){var e=o()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.init();case 2:return e.abrupt("return",p.callAPI("friends.get",{fields:"photo_50"}));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getFriends",value:function(){var e=localStorage.getItem("friends");try{return e?JSON.parse(e):[]}catch(e){return[]}}},{key:"setFriends",value:function(e){localStorage.setItem("friends",JSON.stringify(e))}}]),e}(),F=function(e,n){return e.findIndex(function(e){return e.id===+n})},y=function(e,n){return e.toLowerCase().includes(n.toLowerCase())},g=function(e,n){return e.filter(function(e){return y(e.first_name,n)||y(e.last_name,n)})},b=function(){function e(n,t){d()(this,e),this.friendsAll=n,this.friendsFav=t,this.filterFriends()}return c()(e,[{key:"addFriend",value:function(e){var n=F(this.friendsAll,e),t=this.friendsAll[n];t.favorites=!0,this.friendsAll.splice(n,1),this.friendsFav.push(t)}},{key:"removeFriend",value:function(e){var n=F(this.friendsFav,e),t=this.friendsFav[n];delete t.favorites,this.friendsFav.splice(n,1),this.friendsAll.push(t),this.friendsAll.sort(function(e,n){return e.id-n.id})}},{key:"filterFriends",value:function(){var e=this;this.friendsAll=this.friendsAll.filter(function(n){return!e.friendsFav.some(function(e){return e.id===n.id})})}}]),e}(),A=t(10),k=t.n(A),O=function(){function e(){d()(this,e)}return c()(e,null,[{key:"render",value:function(e,n){var t=k()(n);e.innerHTML=t}}]),e}(),_=function(){function e(n){d()(this,e),this.model=n,this.filters={textAll:"",textFav:""},this.friendsAllDOM=document.querySelector("#all"),this.friendsFavDOM=document.querySelector("#fav"),this.renderAll(),this.renderFav(),this.friendsAllDOM.addEventListener("click",this.addFriend.bind(this)),this.friendsFavDOM.addEventListener("click",this.removeFriend.bind(this)),this.friendsAllDOM.addEventListener("dragstart",this.addFriendDrag.bind(this)),document.querySelector("#input-all").addEventListener("input",this.filterAll.bind(this)),document.querySelector("#input-fav").addEventListener("input",this.filterFav.bind(this)),document.querySelector("#save-button").addEventListener("click",this.saveFriends.bind(this))}return c()(e,[{key:"renderAll",value:function(){var e=g(this.model.friendsAll,this.filters.textAll);O.render(this.friendsAllDOM,e)}},{key:"renderFav",value:function(){var e=g(this.model.friendsFav,this.filters.textFav);O.render(this.friendsFavDOM,e)}},{key:"addFriend",value:function(e){if("BUTTON"===e.target.tagName){var n=e.target.closest("li").dataset.id;this.model.addFriend(n),this.renderAll(),this.renderFav()}}},{key:"addFriendDrag",value:function(e){var n=this,t=e.target.closest("li").dataset.id,r=function(e){e.preventDefault()};this.friendsFavDOM.addEventListener("dragover",r),this.friendsFavDOM.addEventListener("drop",function e(){n.model.addFriend(t),n.renderAll(),n.renderFav(),n.friendsFavDOM.removeEventListener("dragover",r),n.friendsFavDOM.removeEventListener("drop",e)})}},{key:"removeFriend",value:function(e){if("BUTTON"===e.target.tagName){var n=e.target.closest("li").dataset.id;this.model.removeFriend(n),this.renderAll(),this.renderFav()}}},{key:"filterAll",value:function(e){this.filters.textAll=e.target.value.trim(),this.renderAll()}},{key:"filterFav",value:function(e){this.filters.textFav=e.target.value.trim(),this.renderFav()}},{key:"saveFriends",value:function(){m.setFriends(this.model.friendsFav),alert("Сохранено")}}]),e}();m.loadFriends().then(function(e){var n=m.getFriends(),t=new b(e.items,n);new _(t)}),r.b.add(i.d,i.b,i.a,i.c),r.a.watch()}});
//# sourceMappingURL=main.js.map